---
title: "Build Regression Trees"
author: "Alay Yang, Anna Qian"
date: "10/18/2018"
output: html_document
---

## SSE Function
```{r}
# input:
# P - a vector including weekly prices for the specific category in the particular store
# Y - a vector including weekly sales quantities for the specific category in the particular store
# c - a variable representing the price for the specific category

# output:
# customized SSE

get_sse <- function(P, Y, c)
{
  sse = sum(((P-c)*Y - (P-c)*mean(Y))^2)
  return (sse)
}

```


## Split
```{r}
# input:
# X - a vector including one of the marketing mix
# Y - a vector including weekly sales quantities for the specific category in the particular store
# P - a vector including weekly prices for the specific category in the particular store
# c - a variable representing the price for the specific category
# node - index of the position where the data is splited

# output:
# a new SSE for splited data

get_split_sse<-function(X,Y,P,c,node)
  {
  pos<-which(X<=X[node]) #Decision rule
  Y1<-Y[pos];  Y2<-Y[-pos]; #Split Y by set node
  P1<-P[pos];  P2<-P[-pos]: #Split P by node
  #SSE X1
  sse1<-get_sse(P1,Y1,c)
  #SSE X2
  sse2<-get_sse(P2,Y2,c)
  #Split SSE
  s_sse<- sse1+sse2
  return (s_sse)
}

```


## Find the node with minimum SSE
```{r}
# input:
# X - a vector including one of the marketing mix
# Y - a vector including weekly sales quantities for the specific category in the particular store
# c - a variable representing the price for the specific category
# output:
# the location (node) that would give the minimum SSE if we split the data there

fnd_node <- function(X, Y, c)
{
  node = 1
  min_sse = get_split_sse(X, Y, node, c)
  for (i in 2:length(X)) {
    sse = get_split_sse(X, Y, i, c)
    if (sse < min_sse){
      min_sse = sse
      node = i
    }
  }
  return(node)
}

```


## Build Trees
```{r}



```


